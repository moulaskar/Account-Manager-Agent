2025-07-06 23:19:29 - adk_app - INFO     - create_session_endpoint: Session Id: 8d632253-ad47-4966-9cbf-856a72d30a4e
2025-07-06 23:19:29 - adk_app - INFO     - create_session_endpoint: Session created for user: 3550
2025-07-06 23:19:29 - adk_app - INFO     - create_session_endpoint: Created Session for user: {'id': '8d632253-ad47-4966-9cbf-856a72d30a4e', 'app_name': 'Customer Support Agent', 'user_id': '3550', 'state': {'customer': <account_agent.config.Customer.Customer object at 0x0000020D930B8E30>}, 'events': [], 'last_update_time': 1751869169.3136337}
2025-07-06 23:19:35 - adk_app - INFO     - chat_with_agent: User (1533): hi
2025-07-06 23:19:38 - adk_app - INFO     - ------------------------1:  session_id: 8d632253-ad47-4966-9cbf-856a72d30a4e
2025-07-06 23:19:38 - adk_app - INFO     - Session State: {'customer': <account_agent.config.Customer.Customer object at 0x0000020D92E12960>, 'conversation': "Hi there! I'm an Account Management assistant. I can help you with:\n\n*   **Creating a new account**\n*   **Updating your password**\n*   **Updating your email**\n*   **Updating your contact number**\n*   **Updating your address**\n\nHow can I help you today?"}
2025-07-06 23:19:38 - adk_app - INFO     - last response: Hi there! I'm an Account Management assistant. I can help you with:

*   **Creating a new account**
*   **Updating your password**
*   **Updating your email**
*   **Updating your contact number**
*   **Updating your address**

How can I help you today?
2025-07-06 23:19:38 - adk_app - INFO     - ============================
2025-07-06 23:19:38 - adk_app - INFO     - Full conversation log
2025-07-06 23:19:38 - adk_app - INFO     - Session ID: 8d632253-ad47-4966-9cbf-856a72d30a4e
2025-07-06 23:19:38 - adk_app - INFO     - User ID: 1533
2025-07-06 23:19:38 - adk_app - INFO     - Conversation: Hi there! I'm an Account Management assistant. I can help you with:

*   **Creating a new account**
*   **Updating your password**
*   **Updating your email**
*   **Updating your contact number**
*   **Updating your address**

How can I help you today? 
2025-07-06 23:19:47 - adk_app - INFO     - chat_with_agent: User (6281): update address
2025-07-06 23:19:51 - adk_app - INFO     - ------------------------1:  session_id: 8d632253-ad47-4966-9cbf-856a72d30a4e
2025-07-06 23:19:51 - adk_app - INFO     - Session State: {'customer': <account_agent.config.Customer.Customer object at 0x0000020D930A3CE0>, 'conversation': 'I can help with that. What is your username, password and new address?'}
2025-07-06 23:19:51 - adk_app - INFO     - last response: I can help with that. What is your username, password and new address?
2025-07-06 23:19:51 - adk_app - INFO     - ============================
2025-07-06 23:19:51 - adk_app - INFO     - Full conversation log
2025-07-06 23:19:51 - adk_app - INFO     - Session ID: 8d632253-ad47-4966-9cbf-856a72d30a4e
2025-07-06 23:19:51 - adk_app - INFO     - User ID: 6281
2025-07-06 23:19:51 - adk_app - INFO     - Conversation: I can help with that. What is your username, password and new address? 
2025-07-06 23:20:09 - adk_app - INFO     - chat_with_agent: User (6030): mou, 5678, 159 N Abalone Dr Gilbert AZ 85233
2025-07-06 23:20:13 - adk_app - INFO     - before_tool: update_address
2025-07-06 23:20:13 - adk_app - INFO     - before_tool: Getting Username and Password to Authenticate
2025-07-06 23:20:13 - adk_app - INFO     - before_tool: User 'mou' authenticated successfully.
2025-07-06 23:20:13 - adk_app - INFO     - before_tool: database details {'username': 'mou', 'password': '5678', 'first_name': 'MOUMITA', 'last_name': 'LASKAR', 'email': 'moumita.laskar@gmail.com', 'phone_number': '4805672840', 'address': '159 N Abalone Dr Gilbert AZ 85233'}
2025-07-06 23:20:13 - adk_app - INFO     - Customer object in session state updated for user: mou
2025-07-06 23:20:13 - adk_app - INFO     - before_tool: calling verify_otp_tool
2025-07-06 23:20:13 - adk_app - INFO     - verify_otp_tool: customer is {'user_id': '6030', 'session_id': '8d632253-ad47-4966-9cbf-856a72d30a4e', 'app_name': 'Customer Support Agent', 'session_state': {}, 'username': 'mou', 'password': '5678', 'first_name': 'MOUMITA', 'last_name': 'LASKAR', 'email': 'moumita.laskar@gmail.com', 'new_contact': '4805672840', 'address': '159 N Abalone Dr Gilbert AZ 85233', 'otp': None, 'first_auth': True, 'logs': None}
2025-07-06 23:20:13 - adk_app - INFO     - verify_otp_tool
2025-07-06 23:20:13 - adk_app - INFO     - verify_otp_tool: Verifying OTP with email moumita.laskar@gmail.com
2025-07-06 23:20:13 - adk_app - INFO     - verify_otp_tool: sending OTP 363524
2025-07-06 23:20:13 - adk_app - INFO     - send_otp: Sending OTP to moumita.laskar@gmail.com
2025-07-06 23:20:14 - adk_app - INFO     - send_otp: Sending OTP with message  Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit
MIME-Version: 1.0
Subject: Your OTP for Account Verification
From: mou.laskar@gmail.com
To: moumita.laskar@gmail.com

Your OTP is: 363524

2025-07-06 23:20:14 - adk_app - INFO     - before_tool: authenticate_otp
2025-07-06 23:20:14 - adk_app - INFO     - authenticate_otp: expected OTP 363524
2025-07-06 23:20:14 - adk_app - INFO     - authenticate_otp: user_input_otp OTP None
2025-07-06 23:20:14 - adk_app - INFO     - error: Incorrect OTP. Please try again. 
2025-07-06 23:20:17 - adk_app - INFO     - ------------------------1:  session_id: 8d632253-ad47-4966-9cbf-856a72d30a4e
2025-07-06 23:20:17 - adk_app - INFO     - Session State: {'customer': <account_agent.config.Customer.Customer object at 0x0000020D93116720>, 'expected_otp': '363524', 'otp_created_time': 1751869213.30053, 'conversation': 'I am sorry, the OTP was incorrect. Please try again.'}
2025-07-06 23:20:17 - adk_app - INFO     - last response: I am sorry, the OTP was incorrect. Please try again.
2025-07-06 23:20:17 - adk_app - INFO     - ============================
2025-07-06 23:20:17 - adk_app - INFO     - Full conversation log
2025-07-06 23:20:17 - adk_app - INFO     - Session ID: 8d632253-ad47-4966-9cbf-856a72d30a4e
2025-07-06 23:20:17 - adk_app - INFO     - User ID: 6030
2025-07-06 23:20:17 - adk_app - INFO     - Conversation: I am sorry, the OTP was incorrect. Please try again. 
